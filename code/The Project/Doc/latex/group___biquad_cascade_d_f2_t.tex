\hypertarget{group___biquad_cascade_d_f2_t}{\section{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}
\label{group___biquad_cascade_d_f2_t}\index{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure@{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group___biquad_cascade_d_f2_t_ga646c25998bf35991c60299b1431460f7}{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32} (const \hyperlink{structarm__biquad__cascade__df2_t__instance__f32}{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-instance\-\_\-f32} $\ast$S, float32\-\_\-t $\ast$p\-Src, float32\-\_\-t $\ast$p\-Dst, uint32\-\_\-t block\-Size)
\begin{DoxyCompactList}\small\item\em Processing function for the floating-\/point transposed direct form I\-I Biquad cascade filter. \end{DoxyCompactList}\item 
void \hyperlink{group___biquad_cascade_d_f2_t_ga70eaddf317a4a8bde6bd6a97df67fedd}{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32} (\hyperlink{structarm__biquad__cascade__df2_t__instance__f32}{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-instance\-\_\-f32} $\ast$S, uint8\-\_\-t num\-Stages, float32\-\_\-t $\ast$p\-Coeffs, float32\-\_\-t $\ast$p\-State)
\begin{DoxyCompactList}\small\item\em Initialization function for the floating-\/point transposed direct form I\-I Biquad cascade filter. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This set of functions implements arbitrary order recursive (I\-I\-R) filters using a transposed direct form I\-I structure. The filters are implemented as a cascade of second order Biquad sections. These functions provide a slight memory savings as compared to the direct form I Biquad filter functions. Only floating-\/point data is supported.

This function operate on blocks of input and output data and each call to the function processes {\ttfamily block\-Size} samples through the filter. {\ttfamily p\-Src} points to the array of input data and {\ttfamily p\-Dst} points to the array of output data. Both arrays contain {\ttfamily block\-Size} values.

\begin{DoxyParagraph}{Algorithm }
Each Biquad stage implements a second order filter using the difference equation\-: 
\begin{DoxyPre}   
   y[n] = b0 * x[n] + d1   
   d1 = b1 * x[n] + a1 * y[n] + d2   
   d2 = b2 * x[n] + a2 * y[n]   
\end{DoxyPre}
 where d1 and d2 represent the two state values.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
A Biquad filter using a transposed Direct Form I\-I structure is shown below.  Coefficients {\ttfamily b0, b1, and b2 } multiply the input signal {\ttfamily x\mbox{[}n\mbox{]}} and are referred to as the feedforward coefficients. Coefficients {\ttfamily a1} and {\ttfamily a2} multiply the output signal {\ttfamily y\mbox{[}n\mbox{]}} and are referred to as the feedback coefficients. Pay careful attention to the sign of the feedback coefficients. Some design tools flip the sign of the feedback coefficients\-: 
\begin{DoxyPre}   
   y[n] = b0 * x[n] + d1;   
   d1 = b1 * x[n] - a1 * y[n] + d2;   
   d2 = b2 * x[n] - a2 * y[n];   
\end{DoxyPre}
 In this case the feedback coefficients {\ttfamily a1} and {\ttfamily a2} must be negated when used with the C\-M\-S\-I\-S D\-S\-P Library.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
Higher order filters are realized as a cascade of second order sections. {\ttfamily num\-Stages} refers to the number of second order stages used. For example, an 8th order filter would be realized with {\ttfamily num\-Stages=4} second order stages. A 9th order filter would be realized with {\ttfamily num\-Stages=5} second order stages with the coefficients for one of the stages configured as a first order filter ({\ttfamily b2=0} and {\ttfamily a2=0}).
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
{\ttfamily p\-State} points to the state variable array. Each Biquad stage has 2 state variables {\ttfamily d1} and {\ttfamily d2}. The state variables are arranged in the {\ttfamily p\-State} array as\-: 
\begin{DoxyPre}   
    \{d11, d12, d21, d22, ...\}   
\end{DoxyPre}
 where {\ttfamily d1x} refers to the state variables for the first Biquad and {\ttfamily d2x} refers to the state variables for the second Biquad. The state array has a total length of {\ttfamily 2$\ast$num\-Stages} values. The state variables are updated after each block of data is processed; the coefficients are untouched.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
The C\-M\-S\-I\-S library contains Biquad filters in both Direct Form I and transposed Direct Form I\-I. The advantage of the Direct Form I structure is that it is numerically more robust for fixed-\/point data types. That is why the Direct Form I structure supports Q15 and Q31 data types. The transposed Direct Form I\-I structure, on the other hand, requires a wide dynamic range for the state variables {\ttfamily d1} and {\ttfamily d2}. Because of this, the C\-M\-S\-I\-S library only has a floating-\/point version of the Direct Form I\-I Biquad. The advantage of the Direct Form I\-I Biquad is that it requires half the number of state variables, 2 rather than 4, per Biquad stage.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Instance Structure }
The coefficients and state variables for a filter are stored together in an instance data structure. A separate instance structure must be defined for each filter. Coefficient arrays may be shared among several instances while state variable arrays cannot be shared.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Init Functions }
There is also an associated initialization function. The initialization function performs following operations\-:
\begin{DoxyItemize}
\item Sets the values of the internal structure fields.
\item Zeros out the values in the state buffer.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
Use of the initialization function is optional. However, if the initialization function is used, then the instance structure cannot be placed into a const data section. To place an instance structure into a const data section, the instance structure must be manually initialized. Set the values in the state buffer to zeros before static initialization. For example, to statically initialize the instance structure use 
\begin{DoxyPre}   
    \hyperlink{structarm__biquad__cascade__df2_t__instance__f32}{arm\_biquad\_cascade\_df2T\_instance\_f32} S1 = \{numStages, pState, pCoeffs\};   
\end{DoxyPre}
 where {\ttfamily num\-Stages} is the number of Biquad stages in the filter; {\ttfamily p\-State} is the address of the state buffer. {\ttfamily p\-Coeffs} is the address of the coefficient buffer; 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{group___biquad_cascade_d_f2_t_ga646c25998bf35991c60299b1431460f7}{\index{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure@{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}!arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32@{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32}}
\index{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32@{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32}!Biquad Cascade IIR Filters Using a Direct Form II Transposed Structure@{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}}
\subsubsection[{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32}]{\setlength{\rightskip}{0pt plus 5cm}void arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-f32 (
\begin{DoxyParamCaption}
\item[{const {\bf arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-instance\-\_\-f32} $\ast$}]{S, }
\item[{float32\-\_\-t $\ast$}]{p\-Src, }
\item[{float32\-\_\-t $\ast$}]{p\-Dst, }
\item[{uint32\-\_\-t}]{block\-Size}
\end{DoxyParamCaption}
)}}\label{group___biquad_cascade_d_f2_t_ga646c25998bf35991c60299b1431460f7}


Processing function for the floating-\/point transposed direct form I\-I Biquad cascade filter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$\-S} & points to an instance of the filter data structure. \\
\hline
\mbox{\tt in}  & {\em $\ast$p\-Src} & points to the block of input data. \\
\hline
\mbox{\tt out}  & {\em $\ast$p\-Dst} & points to the block of output data \\
\hline
\mbox{\tt in}  & {\em block\-Size} & number of samples to process. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
none. 
\end{DoxyReturn}
\hypertarget{group___biquad_cascade_d_f2_t_ga70eaddf317a4a8bde6bd6a97df67fedd}{\index{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure@{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}!arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32@{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32}}
\index{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32@{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32}!Biquad Cascade IIR Filters Using a Direct Form II Transposed Structure@{Biquad Cascade I\-I\-R Filters Using a Direct Form I\-I Transposed Structure}}
\subsubsection[{arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32}]{\setlength{\rightskip}{0pt plus 5cm}void arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-init\-\_\-f32 (
\begin{DoxyParamCaption}
\item[{{\bf arm\-\_\-biquad\-\_\-cascade\-\_\-df2\-T\-\_\-instance\-\_\-f32} $\ast$}]{S, }
\item[{uint8\-\_\-t}]{num\-Stages, }
\item[{float32\-\_\-t $\ast$}]{p\-Coeffs, }
\item[{float32\-\_\-t $\ast$}]{p\-State}
\end{DoxyParamCaption}
)}}\label{group___biquad_cascade_d_f2_t_ga70eaddf317a4a8bde6bd6a97df67fedd}


Initialization function for the floating-\/point transposed direct form I\-I Biquad cascade filter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em $\ast$\-S} & points to an instance of the filter data structure. \\
\hline
\mbox{\tt in}  & {\em num\-Stages} & number of 2nd order stages in the filter. \\
\hline
\mbox{\tt in}  & {\em $\ast$p\-Coeffs} & points to the filter coefficients. \\
\hline
\mbox{\tt in}  & {\em $\ast$p\-State} & points to the state buffer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
none
\end{DoxyReturn}
{\bfseries Coefficient and State Ordering\-:} \begin{DoxyParagraph}{}
The coefficients are stored in the array {\ttfamily p\-Coeffs} in the following order\-: 
\begin{DoxyPre}   
    \{b10, b11, b12, a11, a12, b20, b21, b22, a21, a22, ...\}   
\end{DoxyPre}

\end{DoxyParagraph}
\begin{DoxyParagraph}{}
where {\ttfamily b1x} and {\ttfamily a1x} are the coefficients for the first stage, {\ttfamily b2x} and {\ttfamily a2x} are the coefficients for the second stage, and so on. The {\ttfamily p\-Coeffs} array contains a total of {\ttfamily 5$\ast$num\-Stages} values.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
The {\ttfamily p\-State} is a pointer to state array. Each Biquad stage has 2 state variables {\ttfamily d1,} and {\ttfamily d2}. The 2 state variables for stage 1 are first, then the 2 state variables for stage 2, and so on. The state array has a total length of {\ttfamily 2$\ast$num\-Stages} values. The state variables are updated after each block of data is processed; the coefficients are untouched. 
\end{DoxyParagraph}
